Got it! Let me clarify to make sure I understand:
Deduplication Logic:
One row per CLNT_NO (forget TACTIC_ID for now)
Priority: If client has multiple products, keep the Student Loan one
If they have multiple Student Loans, keep the first opened (earliest date)
If they have NO Student Loan but have other products, keep the first opened
Additional Analysis:
Distribution of CUST_ID by LOAN_CATEGORY
Here's the code:
/* Step 1: Deduplicate - prioritize Student Loans */
PROC SQL;
    CREATE TABLE product_summary_unique AS
    SELECT 
        a.*
    FROM LN_OPENED a
    INNER JOIN (
        SELECT 
            CLNT_NO,
            /* Student Loan gets priority 1, everything else gets priority 2 */
            MIN(CASE WHEN LOAN_CATEGORY = 'Student Loan' THEN 1 ELSE 2 END) AS category_priority,
            /* Within same priority, get earliest date */
            MIN(RETAIL_LN_STRT_DT) AS earliest_date
        FROM LN_OPENED
        GROUP BY CLNT_NO
    ) b
    ON a.CLNT_NO = b.CLNT_NO
       AND CASE WHEN a.LOAN_CATEGORY = 'Student Loan' THEN 1 ELSE 2 END = b.category_priority
       AND a.RETAIL_LN_STRT_DT = b.earliest_date
    
    /* If still duplicates (same client, same category, same date), keep first by AR_ID */
    GROUP BY a.CLNT_NO
    HAVING a.AR_ID = MIN(a.AR_ID);
QUIT;

/* Step 2: Create transposed structure */
PROC SQL;
    CREATE TABLE product_summary_transposed AS
    SELECT 
        CLNT_NO,
        
        /* Binary Product Category Flags */
        CASE WHEN LOAN_CATEGORY = 'Student Loan' THEN 1 ELSE 0 END AS PRODUCT_STUDENT_LOAN,
        CASE WHEN LOAN_CATEGORY = 'Revolving Credit' THEN 1 ELSE 0 END AS PRODUCT_REVOLVING_CREDIT,
        CASE WHEN LOAN_CATEGORY = 'Fixed Rate Loan' THEN 1 ELSE 0 END AS PRODUCT_FIXED_RATE,
        CASE WHEN LOAN_CATEGORY = 'Variable Rate Loan' THEN 1 ELSE 0 END AS PRODUCT_VARIABLE_RATE,
        CASE WHEN LOAN_CATEGORY = 'Autoplan Loan' THEN 1 ELSE 0 END AS PRODUCT_AUTO_LOAN,
        CASE WHEN LOAN_CATEGORY = 'Trade Finance' THEN 1 ELSE 0 END AS PRODUCT_TRADE_FINANCE,
        CASE WHEN LOAN_CATEGORY = 'Royal Credit Line' THEN 1 ELSE 0 END AS PRODUCT_ROYAL_CREDIT_LINE,
        CASE WHEN LOAN_CATEGORY NOT IN ('Student Loan', 'Revolving Credit', 'Fixed Rate Loan', 
                                        'Variable Rate Loan', 'Autoplan Loan', 'Trade Finance',
                                        'Royal Credit Line') THEN 1 ELSE 0 END AS PRODUCT_OTHER,
        
        /* Binary Status Flags */
        CASE WHEN STATUS = '3' THEN 1 ELSE 0 END AS STATUS_OPEN,
        CASE WHEN STATUS = '4' THEN 1 ELSE 0 END AS STATUS_DELINQUENT,
        CASE WHEN STATUS = '5' THEN 1 ELSE 0 END AS STATUS_IMPAIRED,
        CASE WHEN STATUS = '8' THEN 1 ELSE 0 END AS STATUS_CANCELLED,
        
        /* Continuous Fields */
        AUTHORIZED_AMT AS PRODUCT_AUTHORIZED_AMT FORMAT=DOLLAR20.2,
        GUAR_AMT AS PRODUCT_GUARANTEE_AMT FORMAT=DOLLAR20.2,
        RETAIL_LN_STRT_DT AS PRODUCT_OPEN_DATE FORMAT=DATE9.,
        
        /* Keep raw fields */
        LOAN_CATEGORY AS PRODUCT_CATEGORY,
        STATUS AS PRODUCT_STATUS,
        AR_ID AS PRODUCT_AR_ID,
        CUST_ID
        
    FROM product_summary_unique;
QUIT;

/* Step 3: Distribution of CUST_ID by LOAN_CATEGORY */
PROC SQL;
    CREATE TABLE cust_id_by_category AS
    SELECT 
        LOAN_CATEGORY,
        CUST_ID,
        COUNT(*) AS n_clients,
        SUM(AUTHORIZED_AMT) AS total_authorized FORMAT=DOLLAR20.2,
        MEAN(AUTHORIZED_AMT) AS avg_authorized FORMAT=DOLLAR12.2
    FROM LN_OPENED
    GROUP BY LOAN_CATEGORY, CUST_ID
    ORDER BY LOAN_CATEGORY, n_clients DESC;
QUIT;

/* Print the distribution */
PROC PRINT DATA=cust_id_by_category;
    TITLE "Distribution of CUST_ID by LOAN_CATEGORY";
RUN;
Is this what you wanted?
One row per CLNT_NO with Student Loan priority ✓
CUST_ID distribution by category ✓
Later we'll match to TACTIC_ID by date ✓