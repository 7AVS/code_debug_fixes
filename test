You're right! STATUS is a character field, so MAX() would do alphabetical sorting ('8' > '5' > '4' > '3'), not the priority order we want.
We need explicit priority: 3 (Open) is highest priority → 4 → 5 → 8 (Cancelled) is lowest
Here's the corrected code:
PROC SQL;
    CREATE TABLE product_summary_unique AS
    SELECT 
        a.*
    FROM LN_OPENED a
    INNER JOIN (
        /* Assign priority rank, then get the minimum (highest priority) */
        SELECT 
            CLNT_NO,
            TACTIC_ID,
            MIN(
                CASE STATUS
                    WHEN '3' THEN 1  /* Open - highest priority */
                    WHEN '4' THEN 2  /* Delinquent */
                    WHEN '5' THEN 3  /* Impaired */
                    WHEN '8' THEN 4  /* Cancelled - lowest priority */
                    ELSE 99          /* Unknown status goes last */
                END
            ) AS priority_rank
        FROM LN_OPENED
        GROUP BY CLNT_NO, TACTIC_ID
    ) b
    ON a.CLNT_NO = b.CLNT_NO 
       AND a.TACTIC_ID = b.TACTIC_ID
       AND CASE a.STATUS
               WHEN '3' THEN 1
               WHEN '4' THEN 2
               WHEN '5' THEN 3
               WHEN '8' THEN 4
               ELSE 99
           END = b.priority_rank
    
    /* If still duplicates (same client, tactic, status), keep earliest product */
    GROUP BY a.CLNT_NO, a.TACTIC_ID
    HAVING RETAIL_LN_STRT_DT = MIN(RETAIL_LN_STRT_DT);
QUIT;

/* Now create the transposed structure */
PROC SQL;
    CREATE TABLE product_summary_transposed AS
    SELECT 
        CLNT_NO,
        TACTIC_ID,
        
        /* Binary Product Category Flags */
        CASE WHEN LOAN_CATEGORY = 'Student Loan' THEN 1 ELSE 0 END AS PRODUCT_STUDENT_LOAN,
        CASE WHEN LOAN_CATEGORY = 'Revolving Credit' THEN 1 ELSE 0 END AS PRODUCT_REVOLVING_CREDIT,
        CASE WHEN LOAN_CATEGORY = 'Fixed Rate Loan' THEN 1 ELSE 0 END AS PRODUCT_FIXED_RATE,
        CASE WHEN LOAN_CATEGORY = 'Variable Rate Loan' THEN 1 ELSE 0 END AS PRODUCT_VARIABLE_RATE,
        CASE WHEN LOAN_CATEGORY = 'Autoplan Loan' THEN 1 ELSE 0 END AS PRODUCT_AUTO_LOAN,
        CASE WHEN LOAN_CATEGORY = 'Trade Finance' THEN 1 ELSE 0 END AS PRODUCT_TRADE_FINANCE,
        CASE WHEN LOAN_CATEGORY = 'Royal Credit Line' THEN 1 ELSE 0 END AS PRODUCT_ROYAL_CREDIT_LINE,
        CASE WHEN LOAN_CATEGORY NOT IN ('Student Loan', 'Revolving Credit', 'Fixed Rate Loan', 
                                        'Variable Rate Loan', 'Autoplan Loan', 'Trade Finance',
                                        'Royal Credit Line') THEN 1 ELSE 0 END AS PRODUCT_OTHER,
        
        /* Binary Status Flags */
        CASE WHEN STATUS = '3' THEN 1 ELSE 0 END AS STATUS_OPEN,
        CASE WHEN STATUS = '4' THEN 1 ELSE 0 END AS STATUS_DELINQUENT,
        CASE WHEN STATUS = '5' THEN 1 ELSE 0 END AS STATUS_IMPAIRED,
        CASE WHEN STATUS = '8' THEN 1 ELSE 0 END AS STATUS_CANCELLED,
        
        /* Continuous Fields */
        AUTHORIZED_AMT AS PRODUCT_AUTHORIZED_AMT FORMAT=DOLLAR20.2,
        GUAR_AMT AS PRODUCT_GUARANTEE_AMT FORMAT=DOLLAR20.2,
        RETAIL_LN_STRT_DT AS PRODUCT_OPEN_DATE FORMAT=DATE9.,
        
        /* Keep raw fields for validation */
        LOAN_CATEGORY AS PRODUCT_CATEGORY,
        STATUS AS PRODUCT_STATUS
        
    FROM product_summary_unique;
QUIT;
This prioritizes Status '3' (Open) first, then works down to '8' (Cancelled). Better?