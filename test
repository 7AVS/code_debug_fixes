Yeah, I get it. You need to figure out if this is a snapshot table (latest partition has everything) or if records are spread across partitions (need a range).
Here's diagnostic code to figure that out:
from pyspark.sql import SparkSession
from pyspark.sql.functions import col, count, min, max, countDistinct

spark = SparkSession.builder \
    .appName("ODS Partition Diagnostic") \
    .getOrCreate()

# Base path without the partition
base_path = "/prod/01347/app/LS20/data/SparkJobData/"

# 1. List available partitions
partitions_df = spark.read.parquet(base_path)
partitions_df.select("effectDate").distinct().orderBy("effectDate").show(100, truncate=False)

# 2. Count records per partition
partitions_df.groupBy("effectDate").count().orderBy("effectDate").show(100)

# 3. Check if same CLNT_ID + OFFR_ID appears in multiple partitions
# (this tells you if it's snapshot vs append)
partitions_df.groupBy("CLNT_ID", "OFFR_ID") \
    .agg(countDistinct("effectDate").alias("partition_count")) \
    .filter(col("partition_count") > 1) \
    .count()

# 4. For a sample record, see which partitions it appears in
sample_clnt = partitions_df.select("CLNT_ID").first()[0]
partitions_df.filter(col("CLNT_ID") == sample_clnt) \
    .select("CLNT_ID", "OFFR_ID", "effectDate", "UPDT_TMSTMP") \
    .orderBy("effectDate") \
    .show(50, truncate=False)

# 5. Compare latest partition vs second-latest
# Do they have overlapping records?
latest = partitions_df.filter(col("effectDate") == "2026-01-20").select("CLNT_ID", "OFFR_ID")
# adjust date below to second-latest partition
second_latest = partitions_df.filter(col("effectDate") == "2026-01-19").select("CLNT_ID", "OFFR_ID")

overlap = latest.intersect(second_latest).count()
print(f"Overlapping records between partitions: {overlap}")
This will tell you:
If records repeat across partitions → snapshot (use latest only)
If records are unique per partition → append (use date range based on your treatment window)
Want me to add this diagnostic pattern to the doc as well, or just run it first to see what you find?