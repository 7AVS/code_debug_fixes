CASE 
    /* Fixed Rate Products */
    WHEN LN_DESC IN ('FIXED', 'FR', 'FRINLN', 'FRALTB', 'FRBCB', 'FRCANB', 'FRMANB', 
                     'FRNBB', 'FRNFLB', 'FRNSB', 'FRPEIB', 'FRSKB')
    THEN 'Fixed Rate Loan'
    
    /* Variable Rate Products */
    WHEN LN_DESC IN ('VR', 'V.R.LN', 'VRALTA', 'VRALTB', 'VRBCA', 'VRBCB', 'VRCANA', 'VRCANB',
                     'VRMANA', 'VRMANB', 'VRNBA', 'VRNBB', 'VRNFLA', 'VRNFLB', 'VRNSA', 'VRNSB',
                     'VRPEIA', 'VRPEIB', 'VRSKA', 'VRSKB')
    THEN 'Variable Rate Loan'
    
    /* Student Loans (non-rate specific) */
    WHEN LN_DESC IN ('ALTA-A', 'ALTA-B', 'B.C.-A', 'B.C.-B', 'CAN-A', 'CAN-B', 
                     'MAN-A', 'MAN-B', 'N.S.-A', 'N.S.-B', 'ONT-A', 'ONT-B', 'QUE-A', 'QUE-B',
                     'FEDDIR')
    THEN 'Student Loan'
    
    /* Autoplan */
    WHEN LN_DESC IN ('AUTOPL', 'AUTONP')
    THEN 'Autoplan Loan'
    
    /* Royal Credit Line */
    WHEN LN_DESC IN ('RCL', 'RCLSBC', 'RCLSEC')
    THEN 'Royal Credit Line'
    
    /* RoyFarm */
    WHEN LN_DESC IN ('ROYFRM', 'ROYFRMD', 'RFRMRG')
    THEN 'RoyFarm Loan'
    
    /* Fisherman */
    WHEN LN_DESC IN ('INDFSH', 'FSHDMD')
    THEN 'Fisherman Loan'
    
    /* Grain */
    WHEN LN_DESC IN ('GRNOTH', 'GRNWHT')
    THEN 'Grain Loan'
    
    /* Trade Bill */
    WHEN LN_DESC IN ('TB-DMD', 'TB-TER', 'TBPREC', 'TBTIME')
    THEN 'Trade Bill Loan'
    
    /* US Dollar */
    WHEN LN_DESC IN ('US-B/A', 'US-DMD', 'US-LIB', 'US-TRB', 'USTIME')
    THEN 'US Dollar Loan'
    
    /* Small Business Development Bond */
    WHEN LN_DESC IN ('SBDB', 'GGSBDB')
    THEN 'Small Business Development Bond'
    
    /* Government Guaranteed / Small Business */
    WHEN LN_DESC IN ('G/GOTH', 'G/GUAR', 'SMLBUS')
    THEN 'Government Guaranteed Loan'
    
    /* Savings Bond */
    WHEN LN_DESC IN ('CSBMSP', 'CSBPSP', 'PSBPSP')
    THEN 'Savings Bond Loan'
    
    /* Installment/Term */
    WHEN LN_DESC IN ('INSTAL', 'TER_LN', 'N.TERM', 'TIMRG', 'TP/PC', 'TBTIME')
    THEN 'Installment/Term Loan'
    
    /* Demand Loan */
    WHEN LN_DESC IN ('DEMAND', 'TB-DMD', 'US-DMD', 'FSHDMD', 'ROYFRMD')
    THEN 'Demand Loan'
    
    /* Commercial/Business */
    WHEN LN_DESC IN ('INDBUS', 'IBVRDM', 'ASSCOR', 'CONSUB', 'CITETC', 'TEN-LN', 'B/ACAN')
    THEN 'Commercial/Business Loan'
    
    /* Home Improvement */
    WHEN LN_DESC IN ('HIL')
    THEN 'Home Improvement Loan'
    
    /* Provincial Government */
    WHEN LN_DESC IN ('PRVGOV')
    THEN 'Provincial Government Loan'
    
    /* Pooled/Recourse */
    WHEN LN_DESC IN ('PL-FP', 'PL_FR', 'PL-LP', 'PL-RR')
    THEN 'Pooled/Recourse Loan'
    
    /* Staff */
    WHEN LN_DESC IN ('STAFF')
    THEN 'Staff Loan'
    
    /* Other */
    WHEN LN_DESC IN ('OTH-BR', 'ODWOCB')
    THEN 'Other/Special Loan'
    
    ELSE 'Uncategorized'
END AS LOAN_CATEGORY, 